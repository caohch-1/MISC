---
title: Cryptography-3:Public-key
categories:
- Cryptography 
mathjax: true
---

基于《图解密码技术》@[日]结城浩

# 基本模型

公钥密码系统解决了密钥配送问题，虽然密钥配送问题也可以通过**事先共享**、**密钥分配中心(KDC)**、**Diffie-Hellman密钥交换**等实现，但是前两者存在一些问题，而 **Diffie-Hellman密钥交换**会在以后详细探讨

不同于对称密码系统，公钥密码系统的加密解密使用不同密钥，加密使用**公钥**，解密使用**私钥**

公钥是公开给所有人的，而私钥必须安全地保护好

下图是公钥系统的一个简单模型

![公钥0](https://s1.ax1x.com/2020/08/11/aO9bW9.png)

# RSA

## 加密解密

RSA是现在使用最广泛的公钥密码算法

RSA的加密：$ciphertext=plaintext^E\, mod\, N$

RSA的解密：$plaintext=ciphertext^D\,mod\,N$

**(E,N)是公钥**，**(D,N)是私钥**

这看似非常简单，事实上要达成这样的条件，背后的数学方法并不容易想到

## 生成密钥对

**(E,N)是公钥**，**(D,N)是私钥**，故而求**E、D、N**就是**生成密钥对**

### 求N

准备两个很大的质数$p$、$q$般通过伪随机数生成器生成一个数再判断它时不是质数

接着$N=p\times q$

### 求L

$L$这个数在RSA的加密解密过程中都不出现，只出现在密钥对生成过程中

$L是p-1和q-1的最小公倍数$，即$L=lcm(p-1,q-1)$

### 求E

$E和L的最大公约数是1$，即
$$
1<E<L \\
gcd(E,L)=1
$$
可以借助欧几里德算法实现

### 求D

$D、E、L$之间必须具备以下关系
$$
1<D<L \\
E\times D\,mod\,L=1
$$
下图是密钥对生成流程的示意图

![RSA1](https://s1.ax1x.com/2020/08/11/aOtGTK.png)

## 攻击

![RSA2](https://s1.ax1x.com/2020/08/11/aOtI00.png)

事实上破译的关键在于两个数学问题**离散对数求解问题**和**大整数质因数分解问题**，然而目前都没有高效算法实现

然而还有一种重要的攻击—— **man-in-the-middle attack中间人攻击**

这种攻击无法破译RSA，但却是针对**机密性**的有效攻击，中间人攻击不难理解，通过下图就能清楚展现

事实上，不只是RSA，中间人攻击可以针对所有公钥密码系统

![RSA3](https://s1.ax1x.com/2020/08/11/aONrv9.png)

# 其他的公钥加密系统

EIGamal，缺点是密文长度是明文两倍

Rabin，利用$mod\,N$下求平方根的困难度

Elliptic Curve Cryptography(EEC)椭圆曲线密码，最近备受关注的一种公钥密码算法，通过将椭圆曲线上的特定点进行特殊的乘法运算来实现，利用了这种乘法运算的逆运算非常困难这一特性，详细内容会在以后讲到